<!DOCTYPE HTML>
<html lang="en" class="flint sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Multidimensional Access Patterns - The Flint Wiki</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/flint.css">
        <link rel="stylesheet" href="../../theme/flint-highlight.css">
        <link rel="stylesheet" href="../../version_select.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "flint";
            const default_dark_theme = "flint";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('flint')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Flint Wiki</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="multidimensional-access-patterns"><a class="header" href="#multidimensional-access-patterns">Multidimensional Access Patterns</a></h1>
<p>Just like ranges can be used for one-dimensional arrays for slicing, they can be used for multi-dimensional rectangular arrays as well. There are more things to watch out for for multi-dimensional array slicing, though. The most important part is the one about <strong>dimensionality reduction</strong>, but what even is this? Well, when we create a two-dimensional rectangular array of type <code>i32[,]</code> with <code>i32[10, 10](0)</code> the array has, obviously, a dimensionality of 2. If we now access the multi-dimensional array by it's indices like <code>arr[0, 3]</code> we get a single value, a scalar. This is equivalent to a result array of dimensionality <code>0</code>, being a single value. So, what happens if we use a range instead of a single index when accessing multi-dimensional arrays?</p>
<pre><code class="language-ft">use Core.print

def main():
	i32[,] arr = i32[10, 10](0);
	(I, J) := arr.length;
	for j := 0; j &lt; J; j++:
		for i := 0; i &lt; I; i++:
			arr[i, j] = (i + 1) * (j + 1);

	i32[] slice = arr[1, 2..8];
	for (idx, elem) in slice:
		print($"slice[{idx}] = {elem}\n");
</code></pre>
<p>This program will print these lines to the console:</p>
<blockquote>
<pre><code>slice[0] = 6
slice[1] = 8
slice[2] = 10
slice[3] = 12
slice[4] = 14
slice[5] = 16
</code></pre>
</blockquote>
<p>As you can see, the dimensionality of the array access <code>arr[1, 2..8]</code> is <code>1</code>. This is a fundamental rule of array slicing, and if you think about it a bit more it actually makes a lot of sense. <strong>Every scalar index in an array access reduces the result dimensionality by 1</strong>. So, when we have a 2D array and we access a specific value at a given x and y index, then we get one value, dimensionality 0. But with ranges we can express something even cooler: To access a slice of a multi-dimensional array. Imagine a 10x10 plane, which is our <code>arr</code> in this case. The operation <code>arr[1, 2..8]</code> just means that we look at the second column and from that column we take all elements from the index 2 to 8. Here is a small visualization of that:</p>
<blockquote>
<pre><code>× × × × × × × × × ×
× × × × × × × × × ×
× O × × × × × × × ×
× O × × × × × × × ×
× O × × × × × × × ×
× O × × × × × × × ×
× O × × × × × × × ×
× O × × × × × × × ×
× × × × × × × × × ×
× × × × × × × × × ×
</code></pre>
</blockquote>
<p>All the <code>×</code> mark the original <code>arr</code> and the <code>O</code> are the result of the slicing expression. Okay, so what happens if we do not fix the first index to 1 but provide a range there instead too?</p>
<pre><code class="language-ft">use Core.print

def main():
	i32[,] arr = i32[10, 10](0);
	(I, J) := arr.length;
	for j := 0; j &lt; J; j++:
		for i := 0; i &lt; I; i++:
			arr[i, j] = (i + 1) * (j + 1);

	i32[,] slice = arr[3..6, 2..8];
	for (idx, elem) in slice:
		print($"slice[{idx}] = {elem}\n");
</code></pre>
<p>This program will print these lines to the console:</p>
<blockquote>
<pre><code>slice[0] = 12
slice[1] = 15
slice[2] = 18
slice[3] = 16
slice[4] = 20
slice[5] = 24
slice[6] = 20
slice[7] = 25
slice[8] = 30
slice[9] = 24
slice[10] = 30
slice[11] = 36
slice[12] = 28
slice[13] = 35
slice[14] = 42
slice[15] = 32
slice[16] = 40
slice[17] = 48
</code></pre>
</blockquote>
<p>And when we visualize it again we get this matrix:</p>
<blockquote>
<pre><code>× × × × × × × × × ×
× × × × × × × × × ×
× × × O O O × × × ×
× × × O O O × × × ×
× × × O O O × × × ×
× × × O O O × × × ×
× × × O O O × × × ×
× × × O O O × × × ×
× × × × × × × × × ×
× × × × × × × × × ×
</code></pre>
</blockquote>
<p>And when we print the array we print from left to right before going down. This is why we get all multiples of <code>3</code> first, then the multiples of <code>4</code> and so on. But you may be able to see why ranges and ranged accesses are so powerful for multi-dimensional arrays. Through them we can just extract a plane from a cube, a column from a plane, or like above a small sub-segment array without much hassle. The internal code which handles this all is pretty optimized and it will be faster to use slicing instead of writing your own code to extract a sub-plane from another plane (2d array), for example.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../beginners_guide/6_arrays/8_access_patterns.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../beginners_guide/7_imports.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../beginners_guide/6_arrays/8_access_patterns.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../beginners_guide/7_imports.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../version_select.js"></script>



    </div>
    </body>
</html>
