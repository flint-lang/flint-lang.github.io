<!DOCTYPE HTML>
<html lang="en" class="flint sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Tags - The Flint Wiki</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/flint.css">
        <link rel="stylesheet" href="../../theme/flint-highlight.css">
        <link rel="stylesheet" href="../../version_select.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "flint";
            const default_dark_theme = "flint";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('flint')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Flint Wiki</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="tags"><a class="header" href="#tags">Tags</a></h1>
<p>Let's finally come to tags. They are absoltely essential for Flint's interop capabilities, and they once again would not have been possible without the FIP.</p>
<p>Let's say we have a <code>extern.c</code> file like this:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

typedef struct MyStruct {
    int x;
    float y;
    size_t z;
} MyStruct;

typedef enum MyEnum {
    VAL1 = 0,
    VAL2 = 1,
    VAL3 = 2,
    VAL4 = 4,
    VAL5 = 8,
} MyEnum;

void print_enum(const MyEnum e) {
    if (e == VAL1) {
        printf("is VAL1\n");
    } else if (e == VAL2) {
        printf("is VAL2\n");
    } else if (e == VAL3) {
        printf("is VAL3\n");
    } else if (e == VAL4) {
        printf("is VAL4\n");
    } else if (e == VAL5) {
        printf("is VAL5\n");
    } else {
        printf("is invalid enum value\n");
    }
}

void add_structs(MyStruct *s1, const MyStruct s2) {
    s1-&gt;x += s2.x;
    s1-&gt;y += s2.y;
    s1-&gt;z += s2.z;
}

void add(int *lhs, int rhs) {
    *lhs = *lhs + rhs;
}
</code></pre>
<p>And we define our <code>fip-c.toml</code> to look like this, as usual:</p>
<pre><code class="language-toml">[c]
headers = ["extern.c"]
sources = ["extern.c"]
command = ["gcc", "-c", "__SOURCES__", "-o", "__OUTPUT__"]
</code></pre>
<p>The <em>module tag</em> is the <code>[c]</code> in our case. We could write <em>any</em> text in there, actually. The text should be an identifier, however, so it should only contain alphanumerics and underscores, just like defining any variable or type name in Flint.</p>
<p>Now comes a bit of "magic". This is the Flint code for our example:</p>
<pre><code class="language-ft">use Core.print
use Fip.c

def main():
	s1 := MyStruct(-112, 22.1, 33_302);
	s2 := MyStruct(12, 17.9, 2_698);
	add_structs(&amp;s1, s2);
	print($"s1.(x, y, z) = ({s1.x}, {s1.y}, {s1.z})\n");

	print_enum(MyEnum.VAL3);

	i32 x = 10;
	add(&amp;x, 22);
	print($"x = {x}\n");
</code></pre>
<p>This example prints these lines to the console:</p>
<blockquote>
<pre><code>s1.(x, y, z) = (-100, 40, 36000)
is VAL3
x = 32
</code></pre>
</blockquote>
<p>As you can see we simply wrote <code>use Fip.c</code> and told Flint that it should search through all interop modules for a module which provides a tag called <code>c</code>. Then it found a module containing the <code>c</code> tag and it then auto-generated a file located in the <code>.fip</code> directory. The generated <code>.fip/generated/c.ft</code> file should look like this:</p>
<pre><code class="language-ft">data MyStruct:
	i32 x;
	f32 y;
	u64 z;
	MyStruct(x, y, z);

enum MyEnum:
	VAL1 = 0,
	VAL2 = 1,
	VAL3 = 2,
	VAL4 = 4,
	VAL5 = 8;

extern def print_enum(const MyEnum e);
extern def add_structs(mut MyStruct* s1, const MyStruct s2);
extern def add(mut i32* lhs, mut i32 rhs);
</code></pre>
<p>But that's the beauty of it. You do not need to change a thing, you just tell FIP via the <code>fip-c.toml</code> which files it should search through and it auto-generated a Flint file containing all types and symbols defined in C. If you change your C code, add functions or remove them, the file will re-generate and update accordingly. This also means that it is not recommended to ever change the generated file manually, as the risk of changes becoming lost is extremely high since the compiler (and LSP) will just automatically override the file with the new bindings.</p>
<p>This enables a very fast work-flow when dealing with extern code. You change extern code and get immediate feedback in your Flint code if symbols changed for example.</p>
<h2 id="import-aliasing"><a class="header" href="#import-aliasing">Import aliasing</a></h2>
<p>Because the line <code>use Fip.c</code> results in a <em>real</em> file being generated, we can also alias the import:</p>
<pre><code class="language-rs">use Core.print
use Fip.c as c

def main():
	s1 := c.MyStruct(-112, 22.1, 33_302);
	s2 := c.MyStruct(12, 17.9, 2_698);
	c.add_structs(&amp;s1, s2);
	print($"s1.(x, y, z) = ({s1.x}, {s1.y}, {s1.z})\n");

	c.print_enum(c.MyEnum.VAL3);

	i32 x = 10;
	c.add(&amp;x, 22);
	print($"x = {x}\n");
</code></pre>
<p>This program will print these lines to the console:</p>
<blockquote>
<pre><code>ps1.(x, y, z) = (-100, 40, 36000)
is VAL3
x = 32
</code></pre>
</blockquote>
<p>This means that now <em>all</em> things coming from C need to be prefixed with a <code>c.</code> which is pretty convenient. It also means that there are no naming collisions possible between code from C and code from Flint.</p>
<h2 id="multiple-tags"><a class="header" href="#multiple-tags">Multiple Tags</a></h2>
<p>As you might have guessed already, <code>fip-c</code> is not only limited to one tag either. So, let's add a second file to the <code>extern.c</code>, let's call it <code>ex2.c</code> and it should look like this:</p>
<pre><code class="language-c">typedef struct Vector3 {
    float x, y, z;
} Vector3;

Vector3 vadd(const Vector3 v1, const Vector3 v2) {
    return (Vector3){
        .x = v1.x + v2.x,
        .y = v1.y + v2.y,
        .z = v1.z + v2.z,
    };
}
</code></pre>
<p>Then we simply add the <code>use Fip.ex2 as e</code> line to our code and use the functions and types provided by this additional module:</p>
<pre><code class="language-rs">use Core.print
use Fip.c as c
use Fip.ex2 as e

def main():
	s1 := c.MyStruct(-112, 22.1, 33_302);
	s2 := c.MyStruct(12, 17.9, 2_698);
	c.add_structs(&amp;s1, s2);
	print($"s1.(x, y, z) = ({s1.x}, {s1.y}, {s1.z})\n");

	c.print_enum(c.MyEnum.VAL3);

	i32 x = 10;
	c.add(&amp;x, 22);
	print($"x = {x}\n");

	e.Vector3 v1 = (10.1, 20.2, 30.3);
	e.Vector3 v2 = (20.1, 30.2, 40.3);
	v3 := e.vadd(v1, v2);
	print($"v3 = {v3}\n");
</code></pre>
<p>This program will print these lines to the console:</p>
<blockquote>
<pre><code>s1.(x, y, z) = (-100, 40, 36000)
is VAL3
x = 32
v3 = (30.200001, 50.400002, 70.599998)
</code></pre>
</blockquote>
<p>But wait... how can we print <code>v3</code> directly and how can we assign a group to it without calling the constructor??</p>
<p>Let's look at the <code>ex2.ft</code> which was generated from the <code>ex2.c</code> file:</p>
<pre><code class="language-ft">type Vector3 f32x3
extern def vadd(const Vector3 v1, const Vector3 v2) -&gt; Vector3;
</code></pre>
<p>Aha! Yes, using FIP the Flint compiler is able to detect when a data type overlaps with a multi-type of Flint. In this case <code>Vector3</code> overlaps with the type <code>f32x3</code> and that's why Flint emitted a type-alias to be able to use <code>f32x3</code> as <code>Vector3</code>. As type aliases completely vanish during parse-time it is now possible to assign a value of type <code>e.Vector3</code> to one of type <code>otherexternfile.Vector3</code>. Both <code>Vector3</code>'s will be detected to be equal to a multi-type which means that even if different C libraries provide different <code>Vector3</code> types, for example, we can still use them uniformly in Flint.</p>
<p>By using multiple tags for different source files / different libraries we can ensure that there exist no collisions between them. For example you could define your <code>fip-c.toml</code> file to look like this:</p>
<pre><code class="language-toml">[raylib]
headers = ["/usr/include/raylib.h"]

[sdl]
headers = ["/usr/include/SDL/SDL.h", "/usr/include/SDL/SDL_audio.h"]
</code></pre>
<p>And then in Flint you would just need to write</p>
<pre><code class="language-rs">use Fip.raylib as rl
use Fip.sdl as sdl
</code></pre>
<p>And boom there now no longer exist any collisions between those two libraries and you can use them both in Flint.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../beginners_guide/11_interop/5_pointers.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../beginners_guide/11_interop/7_opaque.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../beginners_guide/11_interop/5_pointers.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../beginners_guide/11_interop/7_opaque.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../version_select.js"></script>


    </div>
    </body>
</html>
