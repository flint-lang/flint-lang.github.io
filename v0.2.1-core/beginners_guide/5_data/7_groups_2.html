<!DOCTYPE HTML>
<html lang="en" class="flint sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Groups 2 - The Flint Wiki</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/flint.css">
        <link rel="stylesheet" href="../../theme/flint-highlight.css">
        <link rel="stylesheet" href="../../version_select.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "flint";
            const default_dark_theme = "flint";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('flint')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Flint Wiki</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="groups-2"><a class="header" href="#groups-2">Groups 2</a></h1>
<p>Until now everything you know about groups is to use them when returning multiple values from a function or when swapping variables. But there is so much more we can do with them. You have learned in the last few chapters that we can define data types, tuples and use multi-types to store multiple values at once. But what if we would want to <em>modify</em> multiple values at once? You may have guessed it from the name of this chapter, but we again can use groups for that!</p>
<h2 id="grouped-access"><a class="header" href="#grouped-access">Grouped Access</a></h2>
<p>Let's start with the most simple form of groups in combination with <code>data</code>: The grouped field access. You have already learned that you can write <code>mydata.field</code> to access a value stored inside the data variable. To access multiple fields at once, we can use the <strong>grouped access</strong> operator <code>.()</code> for that. Here is a small example:</p>
<pre><code class="language-ft">use Core.print

data MyData:
    i32 x;
    f32 y;
    u64 z;
    MyData(x, y, z);

def main():
    MyData m = MyData(10, 3.5, u64(100));
    i32 x = 0;
    f32 y = 0.0;
    u64 z = 0;
    (x, y, z) = m.(x, y, z);
    print($"(x, y, z) = ({x}, {y}, {z})\n");
</code></pre>
<p>This program will print this line to the console:</p>
<blockquote>
<pre><code>(x, y, z) = (10, 3.5, 100)
</code></pre>
</blockquote>
<p>It's actually quite simple. Normally we would write <code>m.x</code> to access a single field and if we would want to create a group of three accesses we would then write <code>(m.x, m.y, m.z)</code>. Just like in math, we can see that the <code>m.</code> is common in each case so we end up with <code>m.(x, y, z)</code>. This is the absolute minimal syntax we could write to access multiple values of the data at once.</p>
<h2 id="grouped-assignment"><a class="header" href="#grouped-assignment">Grouped Assignment</a></h2>
<p>Just like we can access multiple values with the grouped access operator, we can use the same operator for grouped field assignments on data variables. Just like we would write <code>m.x = 5</code> we can express it as a group too:</p>
<pre><code class="language-ft">use Core.print

data MyData:
    i32 x;
    f32 y;
    u64 z;
    MyData(x, y, z);

def main():
    MyData m = MyData(10, 3.5, u64(100));
    m.(x, y, z) = (3, 3.14, u64(33));
    print($"m.(x, y, z) = ({m.x}, {m.y}, {m.z})\n");
</code></pre>
<p>This program will print this line to the console:</p>
<blockquote>
<pre><code>m.(x, y, z) = (3, 3.14, 33)
</code></pre>
</blockquote>
<p>Once you understood the concepts of groups all together, it really becomes second nature writing them. Because normally, without groups, the above code would look like this:</p>
<pre><code class="language-ft">use Core.print

data MyData:
    i32 x;
    f32 y;
    u64 z;
    MyData(x, y, z);

def main():
    MyData m = MyData(10, 3.5, u64(100));
    m.x = 3;
    m.y = 3.14;
    m.z = u64(33);
    print($"m.(x, y, z) = ({m.x}, {m.y}, {m.z})\n");
</code></pre>
<p>This program will, again, write this line to the console:</p>
<blockquote>
<pre><code>m.(x, y, z) = (3, 3.14, 33)
</code></pre>
</blockquote>
<p>Groups make code both more readable and more consise too. But we are far not done yet.</p>
<h2 id="grouped-field-value-swaps"><a class="header" href="#grouped-field-value-swaps">Grouped Field Value Swaps</a></h2>
<p>Just like with direct variable values, we can swap values inside of fields too with one another. But for this example we will use multi-types instead because, yes, you can use grouped accesses / assignments on multitypes (and tuples) too:</p>
<pre><code class="language-ft">use Core.print

def main():
    i32x4 vec4 = (10, 20, 30, 40);
    vec4.(r, g, b, a) = vec4.(b, r, a, g);
    print($"vec4 = {vec4}\n");
</code></pre>
<p>This program will print this line to the console:</p>
<blockquote>
<pre><code>vec4 = (30, 10, 40, 20)
</code></pre>
</blockquote>
<h2 id="vectorization"><a class="header" href="#vectorization">Vectorization</a></h2>
<p>As you can see, in Flint it is trivial to essentially write vector operations in one line of code. A <strong>vector</strong> operation essentially means that the same operation is applied to multiple different values. Each of those values is called a <strong>scalar</strong>. A sclar operation would be something like <code>vec4.x += 5</code> for example, or even a simple addition like <code>x + y</code> is considered a scalar operation, because it's an operation applied to two scalar (single) values. Vector operations are pretty common in modern processors, essentially every single processor has support for them. Most modern AMD and Intel CPUs have the capability to perform vector operations up to at least <code>256 bits</code>, sometimes even higher.</p>
<p>If you want to know more about this topic you need to wait until the later <a href="">SIMD</a> chapter. But essentially this means that the CPU has a 256 bit "budget" for vectorized operations, which means it can apply the same operation on 4 <code>64 bit</code> values or 8 <code>32 bit</code> values at the same time. And these are also the types supported by multi-types: <code>i64x4</code> and <code>i32x8</code>. So, everything you need to know is that the vectorized code has the potential to run as much as <strong>8x faster</strong> than scalar code. So, if you can, <em>always</em> use Flint's multi-types.</p>
<p>But to pull the circle back to grouped operations. Whenever possible, Flint will try to vectorize grouped operations. So, not only are they less to write and easier to read but they also have the potential to be magnitudes faster than scalar operations. Just note that it is <em>not guaranteed</em> for a grouped operation to compile down to a vectorized operation, but it <em>is guaranteed</em> for multi-types.</p>
<h2 id="set-like-comparisons"><a class="header" href="#set-like-comparisons">Set-Like Comparisons</a></h2>
<p>The last thing we talk about for now about groups is that groups can be used for set-like comparisons. It is <em>really</em> powerful and once you have seen and understood it you may see it being appliccable in many different cases. Stay with me for this one, it will be great. First we need to discuss a simple example to get to the point why set-like comparisons are even needed or wanted, so here is a small example (without using the set-like comparisons):</p>
<pre><code class="language-ft">use Core.print

def print_cmp(i32 x):
    if x == 1 or x == 2 or x == 3:
        print($"{x} is 1, 2 or 3\n");

    if x != 1 and x != 2 and x != 3:
        print($"{x} is not 1, 2 or 3\n");

def main():
    for i := 0; i &lt; 5; i++:
        print_cmp(i);
</code></pre>
<p>This program will print these lines to the console:</p>
<blockquote>
<pre><code>0 is not 1, 2 or 3
1 is 1, 2 or 3
2 is 1, 2 or 3
3 is 1, 2 or 3
4 is not 1, 2 or 3
</code></pre>
</blockquote>
<p>The example is not the most useful, but it clearly shows a point. We quite often want to check if a given value is <strong>one of</strong> or <strong>none of</strong> a given set of values. So, it can be quite common to check if a single value is part of a given "set" of values. This is actually much more often used for <code>enum</code>s than it is for other types. We will look at an enum example later, but now let's look at how we would write this using the set-like comparisons:</p>
<pre><code class="language-ft">use Core.print

def print_cmp(i32 x):
    if x == (1, 2, 3):
        print($"{x} is 1, 2 or 3\n");

    if x != (1, 2, 3):
        print($"{x} is not 1, 2 or 3\n");

def main():
    for i := 0; i &lt; 5; i++:
        print_cmp(i);
</code></pre>
<p>This program will have the same output as the last one. But let's look at what's happening here. We compare one <strong>scalar</strong> type to a single group. Flint has one single special rule about these comparisons. We are allowed to compare a scalar value to a group if and only if the type of the scalar is the same type as <strong>every</strong> value inside the group. A group where all elements have the same type is called a <strong>homogeneous group</strong> in Flint.</p>
<p>Both shown examples actually compile down to the same code under the hood, but the grouped set-like comparison make the intent much clearer and it als reads much nicer. But you cannot just use the <code>==</code> and <code>!=</code> operators like this, but actually all comparison operations like <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code> or <code>&gt;=</code> too. So, let's now move on to a smaller example but using enums instead, because it makes a much bigger difference there:</p>
<pre><code class="language-ft">use Core.print

enum MyEnum:
    VAL1, VAL2, VAL3, VAL4, VAL5;

def main():
    MyEnum me = MyEnum.VAL2;
    if me == MyEnum.VAL1 or me == MyEnum.VAL3 or me == MyEnum.VAL5:
        print("is VAL1, VAL3 or VAL5\n");
    else:
        print("is VAL2 or VAL4\n");

    if me == MyEnum.(VAL1, VAL3, VAL5):
        print("is VAL1, VAL3 or VAL5\n");
    else:
        print("is VAL2 or VAL4\n");
</code></pre>
<p>This program will print these lines to the console:</p>
<blockquote>
<pre><code>is VAL2 or VAL4
is VAL2 or VAL4
</code></pre>
</blockquote>
<p>And here you can see the "superpower" of this approach. Because we compare a scalar to a <strong>group</strong>, not a set value, we can use <em>any</em> grouped operation in the comparison. The grouped operation <code>MyEnum.(VAL1, VAL3, VAL5)</code> looks exaclty like a grouped field access, but for enum values. The resulting group will have the result type of <code>(MyEnum, MyEnum, MyEnum)</code>, so it's a homogeneous group and it has the same type as the lhs, namely the type of <code>MyEnum</code>. And the length comparison for the grouped and non-grouped comparison will only grow bigger and bigger, the set-like comparison will look simpler the more values it contiains.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../beginners_guide/5_data/6_multi_types.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../beginners_guide/6_arrays.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../beginners_guide/5_data/6_multi_types.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../beginners_guide/6_arrays.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../version_select.js"></script>



    </div>
    </body>
</html>
